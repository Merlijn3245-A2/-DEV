<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Downloads</title>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <h1>ðŸ“‚ My DownloadsðŸ”¥</h1>

    <!-- Tab buttons -->
    <div id="tabs">
        <button id="btn-media" class="tab active">Media</button>
        <button id="btn-files" class="tab">Downloads</button>
    </div>

    <div id="file-list">Loading files...</div>

    <script>
    const repoOwner = "Merlijn3245-A2";
    const repoName = "-DEV";
    const folderPath = "files";

    const container = document.getElementById("file-list");
    let mediaItems = [];
    let fileItems = [];

    // Load local files
    fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${folderPath}`)
      .then(res => res.json())
      .then(data => {
        data.forEach(item => {
          if (item.type === "file") {
            const ext = item.name.split('.').pop().toLowerCase();
            const type = ["png","jpg","jpeg","gif","webp","mp4","webm","ogg"].includes(ext) ? "media" : "file";
            addFile(item.name, item.download_url, false, type);
          }
        });
        loadExternalLinks();
        showItems("media"); // default tab
      })
      .catch(err => {
        container.textContent = "Error loading files.";
        loadExternalLinks();
      });

    // Load external links
    function loadExternalLinks() {
      fetch(`https://raw.githubusercontent.com/${repoOwner}/${repoName}/main/links.json`)
        .then(res => res.json())
        .then(links => {
          links.forEach(link => addFile(link.name, link.url, true, "file"));
        })
        .catch(() => {});
    }

    // Add file or media
    function addFile(name, url, external, type) {
        const ext = name.split('.').pop().toLowerCase();
        if (type === "media") {
            let el;
            if (["mp4","webm","ogg"].includes(ext)) {
                el = document.createElement("video");
                el.src = url;
                el.controls = true;
            } else {
                el = document.createElement("img");
                el.src = url;
                el.alt = name;
            }
            el.className = "embedded-media";
            mediaItems.push(el);
        } else {
            const a = document.createElement("a");
            a.href = url;
            a.className = "file";
            if (external) {
                a.target = "_blank";
                a.rel = "noopener noreferrer";
            } else {
                a.download = name;
            }
            a.textContent = name;
            fileItems.push(a);
        }
    }

    // Show items based on tab
    function showItems(tab) {
        container.innerHTML = "";
        if (tab === "media") {
            mediaItems.forEach(item => container.appendChild(item));
        } else {
            fileItems.forEach(item => container.appendChild(item));
        }
    }

    // Tab buttons
    document.getElementById("btn-media").onclick = () => {
        showItems("media");
        document.getElementById("btn-media").classList.add("active");
        document.getElementById("btn-files").classList.remove("active");
    };
    document.getElementById("btn-files").onclick = () => {
        showItems("files");
        document.getElementById("btn-files").classList.add("active");
        document.getElementById("btn-media").classList.remove("active");
    };
    </script>
</body>
</html>
